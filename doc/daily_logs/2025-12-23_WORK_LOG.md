# Daily Work Log - 2025-12-23

## 📝 작업 요약 (Summary)

 오늘은 **배포된 애플리케이션의 디자인 및 인증 로직 개선, 그리고 다크 모드와 동적 계산 기능 도입**을 진행했습니다.
초기 배포 상태에서 발견된 메타데이터 미설정, 디자인 불균형, 그리고 인증 리다이렉트 오류를 수정하고 사용자가 자산 현황을 한눈에 파악할 수 있도록 대대적인 UI 개편을 완료했습니다.

### 1. 전역 다크 모드(Dark Mode) 도입
- **문제**: 고정된 밝은 테마로 인해 사용자 환경에 따른 시각적 피로도 발생.
- **해결**: Tailwind 4 기반의 다크 모드를 시스템 전체에 적용했습니다. `ThemeToggle` 컴포넌트를 통해 라이트/다크 모드 전환이 가능하며, 텍스트 대비 및 배경색을 테마에 맞춰 자동 조정합니다.
- **기술적 해결**: 서버-클라이언트 간 속성 불일치(Hydration Mismatch)를 해결하기 위해 `suppressHydrationWarning`을 적용했습니다.

### 2. UI 구조 개편 및 '마이페이지' 신설
- **문제**: 대시보드 메인에 설정, 조회, 관리 기능이 섞여 있어 복잡하고 디자인이 중복됨.
- **해결**: 
    - **TopPanel**: 모든 페이지에서 접근 가능한 상단 바를 만들어 로고와 테마 토글을 배치했습니다. (스크롤 시 함께 이동하도록 설정)
    - **마이페이지(/mypage)**: "종목 추가" 및 "구글 시트 동기화"와 같은 관리 기능을 분리하여 마이페이지로 이관했습니다.
    - **사이드바 정돈**: 중복 로고를 제거하고 아이콘 기반의 간결한 메뉴 체계를 구축했습니다.

### 3. 실시간 포트폴리오 요약 및 지수 정보
- **기능**: 대시보드 상단에 국내 시장 지수(KOSPI, KOSDAQ)를 우선 배치하여 시장 상황을 먼저 파악할 수 있게 했습니다.
- **동적 계산**: 각 종목의 현재가를 실시간으로 페칭하여 **'총 평가금액'**과 **'오늘의 변화'**를 자동 계산하여 표시합니다. 전일 대비 변동폭에 따라 색상(상승-빨강, 하락-파랑)을 적용하여 시각적 직관성을 높였습니다.

### 4. 기타 개선 사항
- **메타데이터**: 사이트 제목 및 설명을 서비스 성격에 맞게 최적화했습니다.
- **데이터 매핑**: 종목 코드(Ticker) 대신 한국어 종목명을 표시하도록 매핑 로직을 강화했습니다.
- **인증 리다이렉트**: 배포 환경(Vercel)과 로컬 환경 모두에서 인증 이메일 리다이렉트가 정확하게 작동하도록 로직을 보완했습니다.

### 5. 관심종목(Watchlist) 및 포트폴리오 관리 고도화
- **기능**: 대시보드 상단에 관심종목 리스트를 배치하여 즐겨찾는 종목을 빠르게 모니터링할 수 있게 했습니다.
- **거래 관리**: 단순 종목 삭제 방식에서 벗어나, 추가 매수/일부 매도 처리가 가능한 거래(Transaction) 시스템을 도입했습니다.
- **실현손익**: 매도 시 매수 평단 대비 수익/손실을 계산하여 대시보드 요약 섹션에 '확정 실현손익'으로 표시합니다.
- **UI**: 분석 패널에서 즉시 관심종목 등록이 가능한 토글 버튼과 개별 종목의 '거래' 다이얼로그를 추가했습니다.

## ✅ 완료된 작업 (Completed)
- [x] Client: 전역 다크 모드 및 테마 토글 버튼 구현.
- [x] Client: TopPanel 통합 및 사이드바 UI 리팩토링.
- [x] Client: 마이페이지 신설 및 포트폴리오 관리 기능 이관.
- [x] Feature: 포트폴리오 총 평가액 및 당일 변동 동적 계산 기능.
- [x] Feature: 한국어 종목명 자동 매핑 적용.
- [x] Backend: Supabase Auth Email Redirect URL 로직 개선.
- [x] Design: 로그인/회원가입 페이지 중앙 정렬 및 디자인 폴리싱.
- [x] Feature: 관심종목(Watchlist) 섹션 및 추가/삭제 기능.
- [x] Feature: 포트폴리오 매수/매도 거래 처리 및 평균 단가 자동 계산.
- [x] Feature: 누적 확정 실현손익 대시보드 표시.
- [x] Database: transactions 테이블 신규 생성 및 portfolios 테이블 컬럼 확장.

## 📌 이슈 및 참고사항 (Issues & Notes)
- **Rate Limiting**: Yahoo Finance API 호출 시 다수의 종목을 조회하므로, 향후 종목 수가 많아질 경우 호출 최적화(Batch 조회 등)가 필요할 수 있습니다.
- **Security**: 금융 API 키 및 민감 데이터는 서버에 저장하지 않는 '로컬 우선' 원칙을 명시했습니다.
